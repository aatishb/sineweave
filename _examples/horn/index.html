---
layout: livecode
title: Horn
category: waveguide
blurb: |
  A (overly) simplified physical waveguide model of resonance in a wind instrument. This is essentially the same as the guitar string model, but we start with an empty buffer and load it with noise on each loop.
---
let output, waveTable;
let freq = 500;
let average = twoPointAverage();
let noise;

function setup() {
  let waveTableLength = Math.round(sampleRate / freq - 0.5);
  waveTable = new WaveTable(waveTableLength);
}

function loop() {

  noise = time.map(whiteNoise).mult(0.1);
  waveTable.update(waveTable.get().add(noise));

  waveTable.delay(128);
  output = waveTable.get().map(average.apply);
  waveTable.update(output);

  return output.mult(0.1);
}
