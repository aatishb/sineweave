---
layout: livecode
title: Horn (Waveguide)
category: instrument
blurb: |
  A simple physical waveguide model of a wind instrument. This is essentially the same as the guitar string model, but we start with an empty wave instead, and add noise to it in each loop. The average filter is replaced with a low pass filter for greater control.
---
let output, waveGuide;
let freq = 500;
let average;
let noise;

function setup() {
  let waveGuideLength = Math.round(sampleRate / freq - 0.5);
  waveGuide = new WaveGuide(waveGuideLength);
  average = twoPointAverage();
}

function loop() {

  noise = noiseWave().mult(0.1);
  waveGuide.set(waveGuide.get().add(noise));

  waveGuide.delay(numSamples);
  output = waveGuide.get().map(average.apply);
  waveGuide.set(output);

  return output.mult(0.1);
}
