<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Delay</title>

    <!-- Bootstrap CSS CDN -->
    <link rel="stylesheet" href=/synthfromscratch/css/bootstrap.min.css>
    <!-- Our Custom CSS -->
    <link rel="stylesheet" href=/synthfromscratch/css/text.css>
    <link rel="stylesheet" href=/synthfromscratch/css/nav.css>
    <link rel="stylesheet" href=/synthfromscratch/css/syntax.css>
    <link rel="stylesheet" href=/synthfromscratch/css/livecode.css>
    <!-- Scrollbar Custom CSS -->
    <link rel="stylesheet" href=/synthfromscratch/css/jquery.mCustomScrollbar.min.css>

</head>

<body>

    <div class="wrapper">
        <!-- Sidebar  -->
        <nav id="sidebar">
            <div class="sidebar-header">
                <h3><a href="/synthfromscratch/">Synth From Scratch</a></h3>
            </div>

            <ul class="list-unstyled components">
                <li class="active">
                  
                    <a href="#oscillatorSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Oscillator</a>
                        <ul class="collapse list-unstyled" id="oscillatorSubmenu">
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/dampedsine/index.html">Damped Sine</a></li>
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/multiple-sine-waves/index.html">Adding Sine Waves</a></li>
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/phasor/index.html">Phasor</a></li>
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/polynomial/index.html">Polynomial</a></li>
                              
                          
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/sawtooth/index.html">Saw Wave</a></li>
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/sine/index.html">Sine Wave</a></li>
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/square/index.html">Square Wave</a></li>
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/triangle/index.html">Triangle Wave</a></li>
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/whitenoise/index.html">White Noise</a></li>
                              
                          
                      </ul>
                  
                    <a href="#envelopeSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Envelope</a>
                        <ul class="collapse list-unstyled" id="envelopeSubmenu">
                          
                              
                              <li><a href="/synthfromscratch/examples/adsr/index.html">ADSR</a></li>
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/drum/index.html">Drum</a></li>
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                      </ul>
                  
                    <a href="#modulationSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Modulation</a>
                        <ul class="collapse list-unstyled" id="modulationSubmenu">
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/am/index.html">Amplitude Modulation</a></li>
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/fm-inharmonic/index.html">Inharmonic FM (bell)</a></li>
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/fm-vary-index/index.html">Modulating FM Index</a></li>
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/fm/index.html">Frequency Modulation</a></li>
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                      </ul>
                  
                    <a href="#filterSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Filter</a>
                        <ul class="collapse list-unstyled" id="filterSubmenu">
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/average/index.html">Average</a></li>
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/comb/index.html">Comb</a></li>
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/delay/index.html">Delay</a></li>
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/highpass/index.html">High Pass Filter</a></li>
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/lowpass/index.html">Low Pass Filter</a></li>
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/resonator/index.html">Resonator</a></li>
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                      </ul>
                  
                    <a href="#synthesisSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Synthesis</a>
                        <ul class="collapse list-unstyled" id="synthesisSubmenu">
                          
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/beatingsawwaves/index.html">Space Drone (Beating Saw Waves)</a></li>
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/clink-additive/index.html">Glass Clink (additive)</a></li>
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/clink-modal/index.html">Glass Clink (modal)</a></li>
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/sawtooth-bandlimited/index.html">Saw Wave (Band Limited)</a></li>
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/square-bandlimited/index.html">Square Wave (Bandlimited)</a></li>
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                      </ul>
                  
                    <a href="#waveguideSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Waveguide</a>
                        <ul class="collapse list-unstyled" id="waveguideSubmenu">
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/string/index.html">Guitar String</a></li>
                              
                          
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/waveguide-string/index.html">Guitar String (Waveguide)</a></li>
                              
                          
                              
                          
                      </ul>
                  
                    <a href="#diffeqSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Diffeq</a>
                        <ul class="collapse list-unstyled" id="diffeqSubmenu">
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/dampedspringfilter/index.html">Damped Spring</a></li>
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                              <li><a href="/synthfromscratch/examples/nonlinearspring/index.html">Nonlinear (Cubic) Spring</a></li>
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                              
                          
                      </ul>
                  
                </li>
              </ul>
        </nav>

        <!-- Page Content  -->
        <div id="content">

            <div id="topbar">
                <img src="/synthfromscratch/assets/bars.svg" alt="expand" id="sidebarCollapse">
            </div>

            <h3>Delay</h3>

<div id="container">
  <div id="menu">
    <img src="/synthfromscratch/assets/play.svg" alt="Play" id="play" class="button">
    <img src="/synthfromscratch/assets/stop.svg" alt="Stop" id="stop" class="button">
  </div>
  <!-- <div id="main"> -->
    <div id="editor"></div>
    <div id="display">
      <div class="plot">
        <h5>Wave</h5>
        <canvas id="scope"></canvas>
      </div>
      <div class="plot">
        <h5>Spectrum</h5>
        <canvas id="spectrum"></canvas>
      </div>
      <div id="dom">
      </div>
    </div>
  <!-- </div> -->
</div>

<script src="/synthfromscratch/libraries/ace.js" type="text/javascript" charset="utf-8"></script>
<script src="/synthfromscratch/libraries/dsp.js" type="text/javascript" charset="utf-8"></script>

<script>
  synth.load(`let amp = 0.05;
let myWave;

function setup() {

}

function loop() {
  myWave = time
    .map(whiteNoise);

  myWave = myWave.delay(10).sub(myWave);

  return myWave.mult(amp);
}
`);
</script>

<p>The delay function implements a delay of m samples. You can think of it like a tiny echo. This is one of the building blocks of sound synthesis, and is used to do things like create the sound of a <a href="https://aatishb.com/synthfromscratch/examples/guitarstring/index.html">plucked guitar string</a>.</p>

<p>Delays are key to simulating sounds, because when a sound wave travels down something like a string, this <a href="https://aatishb.com/synthfromscratch/examples/travellingwave/index.html">travelling wave</a> can be implemented as a looped delay.</p>

<p>In this example, we recreate a comb filter using a delay.</p>

<p>We implement a delay as a circular shift, where a delay of m samples shifts an audio wave by m samples, with wrap-around.</p>

<p>The delay function is defined like this:</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kr">const</span> <span class="nx">delay</span> <span class="o">=</span> <span class="nx">m</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">x</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">x</span><span class="p">[(</span><span class="nx">i</span> <span class="o">+</span> <span class="nx">m</span><span class="p">)</span> <span class="o">%</span> <span class="nx">numSamples</span><span class="p">];</span>
</code></pre>
</div>

<p>Note that this definition only works for integer values of m, with 0 &lt;= m &lt;= 128.</p>


<hr>
<footer>
  <p>The live editor loads the <a href="https://github.com/aatishb/synthfromscratch/blob/master/libraries/dsp.js">synthfromscratch library</a>, which includes some handy functions to synthesize sounds in your browser in real-time.</p>

  <p>Spotted a typo? Have an idea for how to improve this page? Suggest an edit <a href="https://github.com/aatishb/synthfromscratch/edit/master/_examples/delay/index.html">here</a>!</p>
</footer>


        </div>

    </div>

    <!-- jQuery CDN - Slim version (=without AJAX) -->
    <script src="/synthfromscratch/libraries/jquery-3.3.1.slim.min.js" type="text/javascript" charset="utf-8"></script>

    <!-- Bootstrap JS -->
    <script src="/synthfromscratch/libraries/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
    <!-- jQuery Custom Scroller CDN -->
    <script src="/synthfromscratch/libraries/jquery.mCustomScrollbar.concat.min.js" type="text/javascript" charset="utf-8"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            $("#sidebar").mCustomScrollbar({
                theme: "minimal"
            });

            $('#sidebarCollapse').on('click', function () {
                $('#sidebar, #content').toggleClass('active');
                $('.collapse.in').toggleClass('in');
                $('a[aria-expanded=true]').attr('aria-expanded', 'false');
            });
        });
    </script>
</body>

</html>